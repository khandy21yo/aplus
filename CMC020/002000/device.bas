10	  ! &
	  ! Program name: device		Compiled with SCALE 0 on V08.0 &
	  ! Decompiled on 28-Nov-16 at 05:11 PM
50	  ON ERROR GOTO 19000 &
	\ V$=SYS(CHR$(6%)+CHR$(-7%)) &
	\ DIM DEFAULT$(2%), SEARCH$(2%)
60	  CH%=1% &
	\ OPEN "KB:" AS FILE 1%, MODE 8%+256%
70	  ESC$=CHR$(155%) &
	\ CLSCN$=ESC$+"[H"+ESC$+"[J" &
	\ CLRLIN$=ESC$+"[2K" &
	\ CLRBOT$=ESC$+"[21;1H"+ESC$+"[J" &
	\ R.ON$=ESC$+"[7m" &
	\ B.ON$=ESC$+"[1m" &
	\ BLINK.ON$=ESC$+"[5m" &
	\ G.OFF$=ESC$+"[m" &
	\ COLM.ON$=ESC$+"[?3h" &
	\ COLM.OFF$=ESC$+"[?3l" &
	\ LDS.ON$=ESC$+"(0" &
	\ USASCII$=ESC$+"(B"
80	  DROP.DEAD.DATE$="        " &
	\ VERSION.NO$="V1.0" &
	\ DATE.TIME$=SYS(CHR$(6%)+CHR$(20%)+STRING$(2%,0%)+CHR$(1%)+CHR$(SWAP%(1%))+STRING$(11%,0%)+CHR$(SWAP%(0%))+CHR$(1%)+CHR$(SWAP%(1%))) &
	\ IF DROP.DEAD.DATE$<>"" THEN  &
		  IF DROP.DEAD.DATE$<MID(DATE.TIME$,7%,8%) THEN  &
			  MESG$=MID(SYS(CHR$(6%)+CHR$(9%)+CHR$(47%)),3%,30%) &
			\ PRINT #CH%, MESG$;SYS(CHR$(9%))
100	  DEVICE.CH%=2% &
	\ DEVICE.CH%=2% &
	\ CHART.CH%=4% &
	\ MENU.CH%=12% &
	\ LOOP.DATA%=2% &
	\ KEY.LEN%=8% &
	\ DATA.LEN%=64%
200	  IF FNO%(DEVICE.CH%,"DEVICE.DAT","/R0","")=0% THEN  &
		  DEVICE.DEVICE$=CVT$$(MID(FNL$,7%,20%),-1%) IF FNG%(DEVICE.CH%,"DEVICE")=0% &
		\ V%=FNC%(DEVICE.CH%)
300	  V%=FNO%(DEVICE.CH%,DEVICE.DEVICE$+"DEVICE.DAT","/RW","") &
	\ V%=FNO%(DEVICE.CH%,DEVICE.DEVICE$+"DEVICE.DAT","/CR:"+NUM1$(KEY.LEN%)+","+NUM1$(DATA.LEN%),"") IF FNS%=5% &
	\ IF FNS% THEN  &
		  V$=FNMESS$(CH%,FNS%," DEVICE.DAT",0%,-1%) &
		\ GOTO 1040
310	  CHART.FLAG%=FNO%(CHART.CH%,"CHART.DAT","/RO/SF","")
400	  OPEN "MENU.FIL/RO" FOR INPUT AS FILE MENU.CH% &
	\ DIM #12%, A0$(1%)=64% &
	\ COMPANY$=CVT$$(RIGHT(A0$(1%),2%),128%) &
	\ CLOSE MENU.CH%
450	  OPEN "NL:" AS FILE 12%, RECORDSIZE 64% &
	\ FIELD #12%, 6% AS DEVICE.FILE.NAME$,30% AS DEVICE.NAME$ &
	\ FIELD #12%, 6% AS GLOBAL$(1%),30% AS GLOBAL$(2%) &
	\ FIELD #12%, 64% AS DEVICE.BUF$
500	  FRAME$=FRAME$+FNP$(NUM1$(I%)+";1")+" "+FNP$(NUM1$(I%)+";80")+" " FOR I%=2% TO 19% &
	\ COMMAND$=" " &
	\ COMMAND$=COMMAND$+RIGHT(NUM1$(I%+100%),2%)+" " FOR I%=1% TO LOOP.DATA%
1000	  IF FNG%(DEVICE.CH%,"")=0% THEN  &
		  KEY.POINTER%=FNR(DEVICE.CH%) &
		\ DATA.POINTER%=FNR(DEVICE.CH%+1%) &
		\ GOTO 1010
1002	  PRINT #CH%, G.OFF$; &
	\ GOSUB 1060 &
	\ GOTO 1030
1005	  IF FNN%(DEVICE.CH%) THEN &
		  GOTO 18910 &
	  ELSE &
		  KEY.POINTER%=FNR(DEVICE.CH%) &
		\ DATA.POINTER%=FNR(DEVICE.CH%+1%) &
		\ GOTO 1015
1010	  PRINT #CH%, COLM.OFF$;FNSR$("1;24");G.OFF$; &
	\ GOSUB 1060
1015	  GOSUB 6000
1030	  CHNG.FLAG%=0% &
	\ PRINT #CH%, CLRBOT$;G.OFF$;"COMMAND: Add Erase Change Blank";" Initialize Default Global Find Next Restore View";FNP$("22;10");"Quit "; &
	\ OPT$=CVT$$(FNINP$(CH%,128%," ",1%,1%),32%) &
	\ OPT$="A" IF OPT$="" &
	\ GOTO 1030 IF KEY.POINTER%=0% AND INSTR(1%,"AQD",OPT$)=0% &
	\ GOTO 1050 IF OPT$<>"Q"
1040	  PRINT #CH%, CLSCN$;FNSR$("1;24");FNP$("1;75");B.ON$;BLINK.ON$;R.ON$;"WAIT";G.OFF$;FNP$("24;1");FNX%("",0%,"");
1050	  GOTO 1000 IF OPT$="R" &
	\ GOTO 1005 IF OPT$="N" &
	\ GOTO 2000 IF OPT$="A" OR OPT$="F" &
	\ GOTO 2200 IF OPT$="C" OR OPT$="B" &
	\ GOTO 2400 IF OPT$="E" &
	\ GOTO 2500 IF OPT$="D" &
	\ GOTO 2600 IF OPT$="I" &
	\ GOTO 2700 IF OPT$="G" &
	\ GOTO 17000 IF OPT$="V" &
	\ GOTO 1030
1060	  TITLE$="Device File" &
	\ PRINT #CH%, CLSCN$;R.ON$;LEFT(TITLE$,39%);SPACE$(40%-LEN(TITLE$));SPACE$(40%-LEN(COMPANY$));COMPANY$;FRAME$;FNP$("20;1");SPACE$(80%);G.OFF$; &
	\ PRINT #CH%, FNP$("9;20");"(01) File Name";FNP$("11;20");"(02) Device Name"; &
	\ RETURN
2000	  IF OPT$="A" THEN &
		  OPTION$="ADD " &
	  ELSE &
		  OPTION$="FIND "
2010	  INP$,SEARCH.KEY$="" &
	\ FOR LOOP%=1% TO LOOP.DATA% &
		\ INP$=DEFAULT$(LOOP%) IF OPT$="A" &
		\ GOSUB 6030 &
	\ NEXT LOOP% &
	\ FOR LOOP%=1% TO 1% &
		\ ON LOOP% GOSUB 6210,6230,6250 &
		\ SEARCH.KEY$=SEARCH.KEY$+GLOBAL$(LOOP%) &
	\ NEXT LOOP% &
	\ IF OPT$="F" OR FNG%(DEVICE.CH%,SEARCH.KEY$)=0% THEN  &
		  KEY.POINTER%=FNR(DEVICE.CH%) &
		\ DATA.POINTER%=FNR(DEVICE.CH%+1%) &
		\ GOTO 1015
2100	  GOSUB 6010 FOR LOOP%=2% TO LOOP.DATA% &
	\ IF FNA%(DEVICE.CH%,DEVICE.BUF$) THEN  &
		  V$=FNMESS$(CH%,FNS%," DEVICE.DAT",0%,-1%) &
		\ GOTO 1000
2110	  KEY.POINTER%=FNR(DEVICE.CH%) &
	\ DATA.POINTER%=FNR(DEVICE.CH%+1%) &
	\ GOTO 1030
2200	  GOSUB 2910 &
	\ IF INP$="" THEN &
		  GOTO 1030 &
	  ELSE &
		  GOTO 1010
2400	  GOSUB 2920 &
	\ IF INP$<>"Y" THEN &
		  GOTO 1030 &
	  ELSE &
		  GOTO 1005
2500	  OPTION$="DEFAULT " &
	\ FOR LOOP%=1% TO LOOP.DATA% &
		\ INP$=DEFAULT$(LOOP%) &
		\ GOSUB 6030 &
	\ NEXT LOOP%
2510	  PRINT #CH%, CLRBOT$;"Default:"; &
	\ INP$=CVT$$(FNINP$(CH%,128%," ",2%,1%),32%) &
	\ GOTO 1010 IF INP$="" &
	\ LOOP%=(INSTR(1%,COMMAND$," "+INP$+" ")+2%)/3% &
	\ GOTO 2510 IF LOOP%<2% &
	\ GOSUB 6010 &
	\ DEFAULT$(LOOP%)=INP$ &
	\ GOTO 2510
2600	  INITIALIZE$=" " &
	\ INP$="" &
	\ GOSUB 6030 FOR LOOP%=1% TO LOOP.DATA%
2610	  PRINT #CH%, CLRBOT$;FNP$("22;1");INITIALIZE$;FNP$("21;1");"Field to initialize:"; &
	\ INP$=CVT$$(FNINP$(CH%,128%," ",2%,1%),32%) &
	\ IF INP$<>"" THEN  &
		  LOOP%=(INSTR(1%,COMMAND$," "+INP$+" ")+2%)/3% &
		\ INITIALIZE$=INITIALIZE$+INP$+" " IF LOOP%<>0% AND (INSTR(1%,INITIALIZE$," "+INP$+" ")+2%)/3%=0% &
		\ GOTO 2610
2620	  GOTO 1010 IF INITIALIZE$="" &
	\ OPT$="C" &
	\ OPTION$="INITIALIZE " &
	\ CHNG.FLAG%=-1% &
	\ INP$="" &
	\ GOSUB 6030 FOR LOOP%=1% TO LOOP.DATA% &
	\ GOTO 2660
2650	  GOTO 18910 IF FNN%(DEVICE.CH%) &
	\ KEY.POINTER%=FNR(DEVICE.CH%) &
	\ DATA.POINTER%=FNR(DEVICE.CH%+1%)
2660	  GOSUB 6000 &
	\ FOR I%=1% TO LEN(INITIALIZE$)/3% &
		\ LOOP%=(INSTR(1%,COMMAND$,MID(INITIALIZE$,I%*3%-2%,3%))+2%)/3% &
		\ GOSUB 6010 &
		\ IF INP$<>"" THEN  &
			  GOSUB 2900 &
			\ IF FNS% THEN  &
				  V$=FNMESS$(CH%,FNS%," DEVICE.DAT",0%,-1%) &
				\ GOTO 1010
2670			  NEXT I% &
	\ GOTO 2650
2700	  PRINT #CH%, FNP$("20;54");R.ON$;"Record ";FNR(DEVICE.CH%);FNP$("20;67");" of ";FNT;G.OFF$; &
	\ INP$="" &
	\ GOSUB 6030 FOR LOOP%=1% TO LOOP.DATA% &
	\ OPT$="F" &
	\ OPTION$="SEARCH FOR " &
	\ SEARCH$=" " &
	\ SEARCH$(LOOP%)="" FOR LOOP%=1% TO LOOP.DATA%
2710	  PRINT #CH%, CLRBOT$;"Field to search for "; &
	\ INP$=CVT$$(FNINP$(CH%,128%," ",2%,1%),32%) &
	\ IF INP$="" THEN  &
		  GOTO 1010 IF SEARCH$=" " &
		\ SEARCH.LEN%=LEN(SEARCH$)/3% &
		\ CLOSE CH% &
		\ JUNK$=SYS(CHR$(3%)) &
		\ PRINT R.ON$;FNP$("20;38");"Searching. . . ";G.OFF$ &
		\ GLOBAL%=1% &
		\ GOTO 2735
2715	  LOOP%=(INSTR(1%,COMMAND$," "+INP$+" ")+2%)/3% &
	\ GOTO 2710 IF LOOP%=0% OR (INSTR(1%,SEARCH$," "+INP$+" ")+2%)/3% &
	\ SEARCH$=SEARCH$+INP$+" " &
	\ GOSUB 6010 &
	\ SEARCH$(LOOP%)=GLOBAL$(LOOP%)+"" &
	\ GOTO 2710
2720	  IF FNN%(DEVICE.CH%) THEN  &
		  GLOBAL%=0% &
		\ OPEN "KB:" AS FILE CH%, MODE 8%+256% &
		\ JUNK$=SYS(CHR$(2%)) &
		\ GOTO 18910
2725	  KEY.POINTER%=FNR(DEVICE.CH%) &
	\ DATA.POINTER%=FNR(DEVICE.CH%+1%)
2735	  PRINT R.ON$;FNP$("20;60");KEY.POINTER%;G.OFF$; &
	\ LSET DEVICE.BUF$=FNL$+"" &
	\ FOR I%=1% TO SEARCH.LEN% &
		\ LOOP%=(INSTR(1%,COMMAND$,MID(SEARCH$,I%*3%-2%,3%))+2%)/3% &
		\ GOTO 2740 IF GLOBAL$(LOOP%)=SEARCH$(LOOP%) &
	\ NEXT I% &
	\ GOTO 2720
2740	  OPEN "KB:" AS FILE CH%, MODE 8%+256% &
	\ JUNK$=SYS(CHR$(2%)) &
	\ GOSUB 6000 &
	\ PRINT #CH%, CLRBOT$;"COMMAND: Blank Change Erase"; &
	\ OPT$=CVT$$(FNINP$(CH%,128%," ",1%,1%),32%) &
	\ IF OPT$<>"" THEN  &
		  IF OPT$="E" THEN &
			  GOSUB 2920 &
		  ELSE &
			  GOSUB 2910
2750	  CLOSE CH% &
	\ JUNK$=SYS(CHR$(3%)) &
	\ GOTO 2720
2900	  V%=FNG%(-DEVICE.CH%,NUM1$(KEY.POINTER%))+FNG%(-DEVICE.CH%-1%,NUM1$(DATA.POINTER%)) &
	\ V%=FNU%(DEVICE.CH%,DEVICE.BUF$) IF LOOP%>1% AND FNS%=0% &
	\ V%=FNU%(-DEVICE.CH%,DEVICE.BUF$) IF LOOP%<2% AND FNS%=0% &
	\ RETURN
2910	  IF OPT$="B" THEN &
		  OPTION$="BLANK " &
	  ELSE &
		  OPTION$="CHANGE " &
		\ CHNG.FLAG%=-1%
2915	  PRINT #CH%, CLRBOT$;OPTION$+":"; &
	\ INP$=CVT$$(FNINP$(CH%,128%," ",2%,1%),32%) &
	\ GOTO 2919 IF INP$="" &
	\ LOOP%=(INSTR(1%,COMMAND$," "+INP$+" ")+2%)/3% &
	\ GOTO 2915 IF LOOP%=0% AND OPT$="C" OR LOOP%<2% AND OPT$="B" &
	\ IF OPT$="C" THEN &
		  GOSUB 6010 &
	  ELSE &
		  INP$="" &
		\ GOSUB 6030
2917	  GOSUB 2900 &
	\ GOTO 2915 IF FNS%=0% &
	\ V$=FNMESS$(CH%,FNS%," DEVICE.DAT",0%,-1%)
2919	  RETURN
2920	  PRINT #CH%, CLRBOT$;"Confirm deletion (Yes/No) "; &
	\ INP$=CVT$$(FNINP$(CH%,128%," ",1%,1%),32%) &
	\ GOTO 2925 IF INP$<>"Y" &
	\ V%=FNG%(-DEVICE.CH%,NUM1$(KEY.POINTER%))+FNG%(-DEVICE.CH%-1%,NUM1$(DATA.POINTER%)) &
	\ IF FND%(DEVICE.CH%,"") THEN &
		  V$=FNMESS$(CH%,FNS%," DEVICE.DAT",0%,-1%) &
	  ELSE &
		  PRINT #CH%, FNP$("24;1");CLRLIN$;"Record has been erased.";FNP$("24;55");"Hit any key to continue "; &
		\ NW$=FNINP$(CH%,128%," ",1%,1%)
2925	  RETURN
6000	  RETURN IF DATA.POINTER%=0% OR FNG%(-DEVICE.CH%,NUM1$(KEY.POINTER%))+FNG%(-DEVICE.CH%-1%,NUM1$(DATA.POINTER%)) &
	\ LSET DEVICE.BUF$=FNL$+"" &
	\ ON LOOP% GOSUB 6220,6240,6260,6280,6300,6320,6340,6360,6380 FOR LOOP%=1% TO LOOP.DATA% &
	\ RETURN
6010	  ON LOOP% GOSUB 6210,6230,6250,6270,6290,6310,6330,6350,6370 &
	\ RETURN
6030	  ON LOOP% GOSUB 6217,6237,6257,6277,6297,6317,6337,6357,6377 &
	\ RETURN
6200	  !
6210	  INP$=FNSIO$("","9;38",DEVICE.FILE.NAME$,DEFAULT$(LOOP%),CHR$(CH%)+STRING$(2%,LEN(DEVICE.FILE.NAME$))+CHR$(1%)+CHR$(0%)+OPTION$+" ALPHA") &
	\ GOTO 6210 IF INP$="" AND OPT$="A" &
	\ IF OPT$="C" AND INP$<>"" THEN  &
		  IF FNG%(DEVICE.CH%,INP$+SPACE$(KEY.LEN%-2%-LEN(INP$)))=0% THEN  &
			  PRINT #CH%, CLRBOT$;FNP$("24;1");"Duplicate key ";INP$;FNP$("21;1");"COMMAND: Re-enter Exit "; &
			\ IF FNINP$(CH%,128%," ",1%,0%)="R" THEN &
				  GOTO 6210 &
			  ELSE &
				  GOTO 6220
6217	  LSET DEVICE.FILE.NAME$=INP$ IF INP$<>"" OR CHNG.FLAG%=0%
6220	  PRINT #CH%, FNP$("9;38");B.ON$;DEVICE.FILE.NAME$;G.OFF$; &
	\ RETURN
6230	  INP$=FNSIO$("","11;38",DEVICE.NAME$,DEFAULT$(LOOP%),CHR$(CH%)+STRING$(2%,LEN(DEVICE.NAME$))+CHR$(1%)+CHR$(0%)+OPTION$+" ALPHA")
6237	  LSET DEVICE.NAME$=INP$ IF INP$<>"" OR CHNG.FLAG%=0%
6240	  PRINT #CH%, FNP$("11;38");B.ON$;DEVICE.NAME$;G.OFF$; &
	\ RETURN
6250	  !
6257	  !
6260	  !
6270	  !
6277	  !
6280	  !
6290	  !
6297	  !
6300	  !
6310	  !
6317	  !
6320	  !
6330	  !
6337	  !
6340	  !
6350	  !
6357	  !
6360	  !
6370	  !
6377	  !
6380	  !
17000	  PRINT #CH%, CLSCN$;R.ON$;FNSR$("4;19");FNP$("1;1");SPACE$(80%);FNP$("20;1");SPACE$(80%);LDS.ON$;FNP$("2;13");CHR$(120%);FNP$("3;2");STRING$(78%,113%);FNP$("3;13");CHR$(110%);USASCII$; &
	\ PRINT #CH%, FNP$(NUM1$(I%)+";1");" ";FNP$(NUM1$(I%)+";80");" "; FOR I%=2% TO 19% &
	\ PRINT #CH%, G.OFF$;FNP$("2;2");"File Name";FNP$("2;15");"Device Name"; &
	\ DISPLAY.LINE%=0% &
	\ PRINT.LINE%=4%
17010	  V%=FNG%(-DEVICE.CH%,NUM1$(KEY.POINTER%))+FNG%(-DEVICE.CH%-1%,NUM1$(DATA.POINTER%)) &
	\ GOTO 17105
17100	  GOTO 17200 IF FNN%(DEVICE.CH%)
17105	  LSET DEVICE.BUF$=FNL$+"" &
	\ PRINT #CH%, FNP$(NUM1$(PRINT.LINE%)+";2");DEVICE.FILE.NAME$;FNP$(NUM1$(PRINT.LINE%)+";15");DEVICE.NAME$; &
	\ PRINT #CH%, R.ON$;LDS.ON$;FNP$(NUM1$(PRINT.LINE%)+";13");CHR$(120%);USASCII$;G.OFF$; &
	\ PRINT.LINE%=PRINT.LINE%+1% IF PRINT.LINE%<19%
17110	  IF DISPLAY.LINE%>14% THEN  &
		  PRINT #CH%, FNP$("24;55");"Hit any key to continue "; &
		\ INP$=FNINP$(CH%,128%," ",1%,0%) &
		\ GOTO 17210 IF INP$="%^C" &
		\ DISPLAY.LINE%=0% &
		\ PRINT #CH%, CLRBOT$;FNP$(NUM1$(PRINT.LINE%)+";1");
17120	  PRINT #CH% &
	\ DISPLAY.LINE%=DISPLAY.LINE%+1% &
	\ IF PRINT.LINE%=19% THEN  &
		  PRINT #CH%, FNP$(NUM1$(PRINT.LINE%)+";1");R.ON$;" ";FNP$(NUM1$(PRINT.LINE%)+";80");" ";G.OFF$;
17190	  GOTO 17100
17200	  IF DISPLAY.LINE%>0% THEN  &
		  PRINT #CH%, FNP$("24;1");"End of file.";FNP$("24;55");"Hit any key to continue "; &
		\ INP$=FNINP$(CH%,128%," ",1%,0%)
17210	  V%=FNG%(-DEVICE.CH%,NUM1$(KEY.POINTER%))+FNG%(-DEVICE.CH%-1%,NUM1$(DATA.POINTER%)) &
	\ PRINT #CH%, FNP$("1;1");FNSR$("1;24");COLM.OFF$; &
	\ GOTO 1010
18910	  PRINT #CH%, CLRBOT$;FNP$("24;1");"End of file has been reached.";FNP$("24;55");"Hit any key to continue "; &
	\ NW$=FNINP$(CH%,128%," ",1%,0%) &
	\ GOTO 1000
19000	  IF GLOBAL% THEN  &
		  V$=SYS(CHR$(6%)+CHR$(-7%)) &
		\ GLOBAL%=0% &
		\ JUNK$=SYS(CHR$(2%)) &
		\ RESUME 1010 IF ERR=54% &
		\ OPEN "KB:" AS FILE CH%, MODE 8%+256% &
		\ RESUME 1000
19010	  RESUME  IF ERR=52% OR ERR=51% &
	\ RESUME 450 IF ERL=400% &
	\ RESUME 1010 IF ERR=54% &
	\ ON ERROR GOTO 0
30000	  DEF FNINP$(CHN%,KYP%,FILLCHAR$,INPUTLEN%,TO.ERR%) &
	\ PRINT #CHN%, STRING$(INPUTLEN%,ASCII(FILLCHAR$));STRING$(INPUTLEN%,8%); &
	\ PRINT #CHN%, RECORD 256%,CHR$(KYP%+INPUTLEN%)+FILLCHAR$; &
	\ GET #CHN% &
	\ FIELD #CHN%, RECOUNT AS BUFFER$ &
	\ BUFFER$="%^C" IF INSTR(1%,BUFFER$,CHR$(3%)) &
	\ FNINP$=CVT$$(BUFFER$,4%) &
	\ V=SQR(-1.) IF BUFFER$="%^C" AND TO.ERR% &
	\ FNEND
30200	  DEF FNP$(ROWCOL$) &
	\ FNP$=ESC$+"["+ROWCOL$+"H" &
	\ FNEND
30250	  DEF FNMESS$(CHN%,ERRNUM%,DESC$,TO.ERR%,PRINT.TEST%) &
	\ MESG$=MID(SYS(CHR$(6%)+CHR$(9%)+CHR$(ERRNUM%)),3%,30%)+DESC$ &
	\ IF PRINT.TEST% THEN  &
		  PRINT #CHN%, FNP$("24;1");CLRLIN$;MESG$;FNP$("24;55");"Hit any key to continue"; &
		\ NW$=FNINP$(CHN%,128%," ",1%,TO.ERR%)
30260	  FNMESS$=MESG$ &
	\ FNEND
30280	  DEF FNSR$(BEGEND$) &
	\ FNSR$=ESC$+"["+BEGEND$+"r" &
	\ FNEND
30300	  DEF FNT24S$(TYME$) &
	\ FNT24S$=CHR$(VAL(MID(TYME$,21%,2%)))+CHR$(VAL(MID(TYME$,24%,2%))) &
	\ FNEND
30310	  DEF FNT24P$(TYME$) &
	\ FNT24P$=RIGHT(NUM1$(100%+ASCII(LEFT(TYME$,1%))),2%)+":"+RIGHT(NUM1$(100%+ASCII(RIGHT(TYME$,2%))),2%) &
	\ FNEND
30400	  DEF FND8%(D8) &
	\ FND8%=D8 &
	\ FNEND
30410	  DEF FND6%(D9$) &
	\ FND6%=VAL(MID(D9$,3%,2%))+VAL(LEFT(D9$,2%))*32%+FND8%(VAL(RIGHT(D9$,5%)))*512% &
	\ FNEND
30420	  DEF FND6$(D9%) &
	\ FND6$=RIGHT(NUM1$((D9% AND 15%*32%)/32%+100%),2%)+"/"+RIGHT(NUM1$((D9% AND 31%)+100%),2%)+"/"+RIGHT(NUM1$((SWAP%(D9%) AND 254%)/2%+100%),2%) &
	\ FNEND
30430	  DEF FNDREAL%(DATUM$) &
	\ DAY%=VAL(MID(DATUM$,3%,2%)) &
	\ YIR%=VAL(RIGHT(DATUM$,5%)) &
	\ FNDREAL%,P%=0% &
	\ FNDREAL%,P%=31% IF INSTR(1%," 01 03 05 07 08 10 12 "," "+LEFT(DATUM$,2%)+" ") &
	\ FNDREAL%,P%=30% IF INSTR(1%," 04 06 09 11 "," "+LEFT(DATUM$,2%)+" ") &
	\ FNDREAL%,P%=28%+(1%-SGN(YIR%-4%*INT(YIR%/4%)))-(1%-SGN(YIR%)) IF LEFT(DATUM$,2%)="02" &
	\ FNDREAL%=0% IF P%<DAY% OR DAY%=0% &
	\ FNDREAL%=1% IF DATUM$="" &
	\ FNEND
30450	  DEF FNFONE$(PHN$) &
	\ FNFONE$="("+LEFT(PHN$,3%)+")"+MID(PHN$,4%,3%)+"-"+RIGHT(PHN$,7%) &
	\ FNEND
30500	  DEF FNZ(Y) &
	\ TEMP=Y &
	\ TEMP=-Y IF Y<0. &
	\ TEMP=INT(TEMP*100.+6.8213185310482798e-15)/100. &
	\ TEMP=-TEMP IF Y<0. &
	\ FNZ=TEMP &
	\ FNEND
30700	  DEF FNSIO$(FRMAT$,ROWCOL$,VARABLE$,DEFAL$,ITEMS$) &
	\ CHN%=ASCII(MID(ITEMS$,1%,1%)) &
	\ KIND%=ASCII(MID(ITEMS$,4%,1%)) &
	\ DECI=ASCII(MID(ITEMS$,5%,1%)) &
	\ OPT$=MID(ITEMS$,6%,1%)
30705	  PRINT #CHN%, FNP$(ROWCOL$);R.ON$;B.ON$; &
	\ IF OPT$="C" THEN &
		  ON KIND% GOTO 30710,30715,30720,30725,30730 &
	  ELSE &
		  PRINT #CHN%, SPACE$(ASCII(MID(ITEMS$,2%,1%))); &
		\ GOTO 30735
30710	  PRINT #CHN%, VARABLE$; &
	\ GOTO 30735
30715	  PRINT #CHN%, USING FRMAT$, ASCII(VARABLE$); &
	\ GOTO 30735
30720	  PRINT #CHN%, USING FRMAT$, CVT$%(VARABLE$)/10.^DECI; &
	\ GOTO 30735
30725	  PRINT #CHN%, FND6$(CVT$%(VARABLE$)); &
	\ GOTO 30735
30730	  PRINT #CHN%, USING FRMAT$, CVT$F(VARABLE$);
30735	  PRINT #CHN%, G.OFF$;CLRBOT$;RIGHT(ITEMS$,6%)+":  ";B.ON$; &
	\ FIN$=FNINP$(CHN%,0%,"_",ASCII(MID(ITEMS$,3%,1%)),1%) &
	\ V%=VAL(FIN$) IF KIND%=3% &
	\ V=VAL(FIN$) IF KIND%>3% &
	\ IF FIN$="" THEN  &
		  FIN$=DEFAL$ IF INSTR(1%,"CF",OPT$)=0% &
		\ GOTO 30745
30740	  IF KIND%=3% OR KIND%=5% THEN  &
		  TEMP=1. &
		\ TEMP=10.^DECI IF INSTR(1%,FIN$,".")=0% &
		\ FIN$=NUM1$(VAL(FIN$)/TEMP) &
		\ FIN$=FIN$+"." IF INSTR(1%,FIN$,".")=0%
30745	  FNSIO$=FIN$+"" &
	\ FNEND
30800	  DEF FNCOMP%(Y$,Y2$) &
	\ Y9%=0% &
	\ Y9%=-1% IF Y2$="*" &
	\ Y2$=Y2$+","
30820	  IF Y9%=0% THEN  &
		  Y1$=LEFT(Y2$,INSTR(1%,Y2$,",")-1%) &
		\ Y2$=RIGHT(Y2$,LEN(Y1$)+2%) &
		\ Y1%=INSTR(1%,Y1$,"/") &
		\ Y2%=LEN(Y1$)-Y1% &
		\ IF Y1%+INSTR(1%,Y1$,"?")=0% THEN &
			  Y9%=Y$=Y1$ &
		  ELSE &
			  IF Y1% THEN &
				  Y9%=LEFT(Y1$,Y1%-1%)<=LEFT(Y$,Y1%-1%) AND LEFT(Y$,Y2%)<=RIGHT(Y1$,Y1%+1%) &
			  ELSE &
				  CHANGE CVT$$(LEFT(Y$,30%),-1%) TO Y% &
				\ CHANGE CVT$$(LEFT(Y1$,30%),-1%) TO Y1% &
				\ GOTO 30830 IF (Y%(Y3%)<>Y1%(Y3%))-(Y1%(Y3%)=63%) FOR Y3%=1% TO Y1%(0%) &
				\ Y9%=-1%
30830	  GOTO 30820 IF Y2$<>"" AND Y9%=0% &
	\ FNCOMP%=Y9% &
	\ FNEND
32767	  END
